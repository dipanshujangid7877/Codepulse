'use strict';

var octiconsReact = require('@primer/octicons-react');
var clsx = require('clsx');
var React = require('react');
var styled = require('styled-components');
var Text = require('../Text/Text.js');
var constants = require('../constants.js');
var sx = require('../sx.js');
var _VisuallyHidden = require('../_VisuallyHidden.js');
var sorting = require('./sorting.js');
var useTable = require('./useTable.js');
var SkeletonText = require('../experimental/Skeleton/SkeletonText.js');
var ScrollableRegion = require('../ScrollableRegion/ScrollableRegion.js');
require('../FeatureFlags/FeatureFlags.js');
var useFeatureFlag = require('../FeatureFlags/useFeatureFlag.js');
require('../FeatureFlags/DefaultFeatureFlags.js');
var toggleStyledComponent = require('../internal/utils/toggleStyledComponent.js');
var ButtonReset = require('../internal/components/ButtonReset.js');
var Table_module = require('./Table.module.css.js');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var React__default = /*#__PURE__*/_interopDefault(React);
var styled__default = /*#__PURE__*/_interopDefault(styled);

function _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }
const cssModulesFlag = 'primer_react_css_modules_staff';

// ----------------------------------------------------------------------------
// Table
// ----------------------------------------------------------------------------

const StyledTable = toggleStyledComponent.toggleStyledComponent(cssModulesFlag, 'table', styled__default.default.table.withConfig({
  displayName: "Table__StyledTable",
  componentId: "sc-jofqvq-0"
})(["--table-border-radius:0.375rem;--table-cell-padding:var(--cell-padding-block,0.5rem) var(--cell-padding-inline,0.75rem);--table-font-size:0.75rem;background-color:", ";border-spacing:0;border-collapse:separate;display:grid;font-size:var(--table-font-size);grid-template-columns:var(--grid-template-columns);line-height:calc(20 / 12);width:100%;&[data-cell-padding='condensed']{--cell-padding-block:0.25rem;--cell-padding-inline:0.5rem;}&[data-cell-padding='normal']{--cell-padding-block:0.5rem;--cell-padding-inline:0.75rem;}&[data-cell-padding='spacious']{--cell-padding-block:0.75rem;--cell-padding-inline:1rem;}.TableCell:first-child,.TableHeader:first-child{border-left:1px solid ", ";}.TableCell:last-child,.TableHeader:last-child{border-right:1px solid ", ";}.TableHeader,.TableCell{text-align:start;display:flex;align-items:center;border-bottom:1px solid ", ";padding:var(--table-cell-padding);}.TableHeader[data-cell-align='end'],.TableCell[data-cell-align='end']{text-align:end;display:flex;justify-content:flex-end;}.TableHeader[data-cell-align='end'] .TableSortButton{display:flex;flex-direction:row-reverse;}.TableHead .TableRow:first-of-type .TableHeader{border-top:1px solid ", ";}.TableHead .TableRow:first-of-type .TableHeader:first-child{border-top-left-radius:var(--table-border-radius);}.TableHead .TableRow:first-of-type .TableHeader:last-child{border-top-right-radius:var(--table-border-radius);}.TableOverflowWrapper:last-child & .TableBody .TableRow:last-of-type .TableCell:first-child{border-bottom-left-radius:var(--table-border-radius);}.TableOverflowWrapper:last-child & .TableBody .TableRow:last-of-type .TableCell:last-child{border-bottom-right-radius:var(--table-border-radius);}.TableRow > *:first-child:not(.TableCellSkeleton),.TableRow > *:first-child .TableCellSkeletonItem{padding-inline-start:1rem;}.TableRow > *:last-child:not(.TableCellSkeleton),.TableRow > *:last-child .TableCellSkeletonItem{padding-inline-end:1rem;}.TableHeader{background-color:", ";color:", ";font-weight:600;border-top:1px solid ", ";}.TableHeader[aria-sort='descending'],.TableHeader[aria-sort='ascending']{color:", ";}.TableSortIcon{visibility:hidden;}.TableHeader:hover .TableSortIcon--ascending,.TableHeader .TableSortButton:focus .TableSortIcon--ascending{visibility:visible;}.TableHeader[aria-sort='ascending'] .TableSortIcon--ascending,.TableHeader[aria-sort='descending'] .TableSortIcon--descending{visibility:visible;}.TableRow:hover .TableCell:not(.TableCellSkeleton){background-color:", ";}.TableCell[scope='row']{align-items:center;display:flex;color:", ";font-weight:600;}.TableCellSkeleton{padding:0;}.TableCellSkeletonItems{display:flex;flex-direction:column;width:100%;}.TableCellSkeletonItem{padding:var(--table-cell-padding);&:nth-of-type(5n + 1){--skeleton-item-width:85%;}&:nth-of-type(5n + 2){--skeleton-item-width:67.5%;}&:nth-of-type(5n + 3){--skeleton-item-width:80%;}&:nth-of-type(5n + 4){--skeleton-item-width:60%;}&:nth-of-type(5n + 5){--skeleton-item-width:75%;}}.TableCellSkeletonItem [data-component='SkeletonText']{width:var(--skeleton-item-width);}.TableCellSkeletonItem:not(:last-of-type){border-bottom:1px solid ", ";}.TableHead,.TableBody,.TableRow{display:contents;}@supports (grid-template-columns:subgrid){.TableHead,.TableBody,.TableRow{display:grid;grid-template-columns:subgrid;grid-column:-1 /1;}}.TableSortButton{column-gap:0.5rem;}"], constants.get('colors.canvas.default'), constants.get('colors.border.default'), constants.get('colors.border.default'), constants.get('colors.border.default'), constants.get('colors.border.default'), constants.get('colors.canvas.subtle'), constants.get('colors.fg.muted'), constants.get('colors.border.default'), constants.get('colors.fg.default'), constants.get('colors.actionListItem.default.hoverBg'), constants.get('colors.fg.default'), constants.get('colors.border.default')));
const Table = /*#__PURE__*/React__default.default.forwardRef(function Table({
  'aria-labelledby': labelledby,
  cellPadding = 'normal',
  className,
  gridTemplateColumns,
  ...rest
}, ref) {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  return (
    /*#__PURE__*/
    // TODO update type to be non-optional in next major release
    // @ts-expect-error this type should be required in the next major version
    React__default.default.createElement(ScrollableRegion.ScrollableRegion, {
      "aria-labelledby": labelledby,
      className: clsx.clsx('TableOverflowWrapper', {
        [Table_module.TableOverflowWrapper]: enabled
      })
    }, /*#__PURE__*/React__default.default.createElement(StyledTable, _extends({}, rest, {
      "aria-labelledby": labelledby,
      "data-cell-padding": cellPadding,
      className: clsx.clsx(className, {
        Table: true,
        [Table_module.Table]: enabled
      }),
      role: "table",
      ref: ref,
      style: {
        '--grid-template-columns': gridTemplateColumns
      }
    })))
  );
});

// ----------------------------------------------------------------------------
// TableHead
// ----------------------------------------------------------------------------

function TableHead({
  children
}) {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  return (
    /*#__PURE__*/
    // We need to explicitly pass this role because some ATs and browsers drop table semantics
    // when we use `display: contents` or `display: grid` in the table
    React__default.default.createElement("thead", {
      className: clsx.clsx('TableHead', {
        [Table_module.TableHead]: enabled
      }),
      role: "rowgroup"
    }, children)
  );
}
TableHead.displayName = "TableHead"; // ----------------------------------------------------------------------------
// TableBody
// ----------------------------------------------------------------------------
function TableBody({
  children
}) {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  return (
    /*#__PURE__*/
    // We need to explicitly pass this role because some ATs and browsers drop table semantics
    // when we use `display: contents` or `display: grid` in the table
    React__default.default.createElement("tbody", {
      className: clsx.clsx('TableBody', {
        [Table_module.TableBody]: enabled
      }),
      role: "rowgroup"
    }, children)
  );
}
TableBody.displayName = "TableBody"; // ----------------------------------------------------------------------------
// TableHeader
// ----------------------------------------------------------------------------
function TableHeader({
  align,
  children,
  ...rest
}) {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  return /*#__PURE__*/React__default.default.createElement("th", _extends({}, rest, {
    className: clsx.clsx('TableHeader', {
      [Table_module.TableHeader]: enabled
    }),
    role: "columnheader",
    scope: "col",
    "data-cell-align": align
  }), children);
}
TableHeader.displayName = "TableHeader";
function TableSortHeader({
  align,
  children,
  direction,
  onToggleSort,
  ...rest
}) {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  const ariaSort = direction === 'DESC' ? 'descending' : direction === 'ASC' ? 'ascending' : undefined;
  return /*#__PURE__*/React__default.default.createElement(TableHeader, _extends({}, rest, {
    "aria-sort": ariaSort,
    align: align
  }), /*#__PURE__*/React__default.default.createElement(ButtonReset.Button, {
    type: "button",
    className: clsx.clsx('TableSortButton', {
      [Table_module.TableSortButton]: enabled
    }),
    onClick: () => {
      onToggleSort();
    }
  }, children, direction === sorting.SortDirection.NONE || direction === sorting.SortDirection.ASC ? /*#__PURE__*/React__default.default.createElement(octiconsReact.SortAscIcon, {
    className: clsx.clsx('TableSortIcon', 'TableSortIcon--ascending', {
      [Table_module.TableSortIcon]: enabled,
      [Table_module['TableSortIcon--ascending']]: enabled
    })
  }) : null, direction === sorting.SortDirection.DESC ? /*#__PURE__*/React__default.default.createElement(octiconsReact.SortDescIcon, {
    className: clsx.clsx('TableSortIcon', 'TableSortIcon--descending', {
      [Table_module.TableSortIcon]: enabled,
      [Table_module['TableSortIcon--descending']]: enabled
    })
  }) : null));
}
TableSortHeader.displayName = "TableSortHeader"; // ----------------------------------------------------------------------------
// TableRow
// ----------------------------------------------------------------------------
function TableRow({
  children,
  ...rest
}) {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  return /*#__PURE__*/React__default.default.createElement("tr", _extends({}, rest, {
    className: clsx.clsx('TableRow', {
      [Table_module.TableRow]: enabled
    }),
    role: "row"
  }), children);
}
TableRow.displayName = "TableRow"; // ----------------------------------------------------------------------------
// TableCell
// ----------------------------------------------------------------------------
function TableCell({
  align,
  className,
  children,
  scope,
  ...rest
}) {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  const BaseComponent = scope ? 'th' : 'td';
  const role = scope ? 'rowheader' : 'cell';
  return /*#__PURE__*/React__default.default.createElement(BaseComponent, _extends({}, rest, {
    className: clsx.clsx('TableCell', className, {
      [Table_module.TableCell]: enabled
    }),
    scope: scope,
    role: role,
    "data-cell-align": align
  }), children);
}
TableCell.displayName = "TableCell";
function TableCellPlaceholder({
  children
}) {
  return /*#__PURE__*/React__default.default.createElement(Text, {
    color: "fg.subtle"
  }, children);
}
TableCellPlaceholder.displayName = "TableCellPlaceholder";
// ----------------------------------------------------------------------------
// TableContainer
// ----------------------------------------------------------------------------
const StyledTableContainer = toggleStyledComponent.toggleStyledComponent(cssModulesFlag, 'div', styled__default.default.div.withConfig({
  displayName: "Table__StyledTableContainer",
  componentId: "sc-jofqvq-1"
})(["display:grid;grid-template-columns:1fr 1fr;grid-template-areas:'title actions' 'divider divider' 'subtitle subtitle' 'filter filter' 'table table' 'footer footer';column-gap:", ";", " .TableTitle{grid-area:title;align-self:center;}.TableSubtitle{grid-area:subtitle;}.TableActions{display:flex;column-gap:", ";align-items:center;grid-area:actions;justify-self:end;}.TableDivider{grid-area:divider;margin-top:", ";margin-bottom:", ";}.Table{grid-area:table;}.TableTitle + .TableOverflowWrapper,.TableSubtitle + .TableOverflowWrapper,.TableActions + .TableOverflowWrapper{margin-top:", ";}.TableOverflowWrapper{grid-area:table;}"], constants.get('space.2'), sx.default, constants.get('space.2'), constants.get('space.3'), constants.get('space.2'), constants.get('space.2')));
function TableContainer({
  children,
  sx
}) {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  return /*#__PURE__*/React__default.default.createElement(StyledTableContainer, {
    className: clsx.clsx({
      [Table_module.TableContainer]: enabled
    }),
    sx: sx
  }, children);
}
TableContainer.displayName = "TableContainer";
const TableTitle = /*#__PURE__*/React__default.default.forwardRef(function TableTitle({
  as = 'h2',
  children,
  id
}, ref) {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  return /*#__PURE__*/React__default.default.createElement(StyledTableTitle, {
    as: as,
    className: clsx.clsx('TableTitle', {
      [Table_module.TableTitle]: enabled
    }),
    id: id,
    ref: ref
  }, children);
});
const StyledTableTitle = toggleStyledComponent.toggleStyledComponent(cssModulesFlag, 'h2', styled__default.default.h2.withConfig({
  displayName: "Table__StyledTableTitle",
  componentId: "sc-jofqvq-2"
})(["color:var(--fgColor-default);font-size:var(--text-body-size-medium);font-weight:var(--base-text-weight-semibold);line-height:calc(20 / 14);margin:0;"]));
function TableSubtitle({
  as,
  children,
  id
}) {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  return /*#__PURE__*/React__default.default.createElement(StyledTableSubtitle, {
    as: as,
    className: clsx.clsx('TableSubtitle', {
      [Table_module.TableSubtitle]: enabled
    }),
    id: id
  }, children);
}
TableSubtitle.displayName = "TableSubtitle";
const StyledTableSubtitle = toggleStyledComponent.toggleStyledComponent(cssModulesFlag, 'div', styled__default.default.div.withConfig({
  displayName: "Table__StyledTableSubtitle",
  componentId: "sc-jofqvq-3"
})(["color:var(--fgColor-default);font-weight:var(--base-text-weight-normal);font-size:var(--text-body-size-small);line-height:var(--text-title-lineHeight-small);margin:0;"]));
function TableDivider() {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  return /*#__PURE__*/React__default.default.createElement(StyledTableDivider, {
    className: clsx.clsx('TableDivider', {
      [Table_module.TableDivider]: enabled
    }),
    role: "presentation"
  });
}
TableDivider.displayName = "TableDivider";
const StyledTableDivider = toggleStyledComponent.toggleStyledComponent(cssModulesFlag, 'div', styled__default.default.div.withConfig({
  displayName: "Table__StyledTableDivider",
  componentId: "sc-jofqvq-4"
})(["background-color:var(--borderColor-default);width:100%;height:1px;"]));
function TableActions({
  children
}) {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  return /*#__PURE__*/React__default.default.createElement("div", {
    className: clsx.clsx('TableActions', {
      [Table_module.TableActions]: enabled
    })
  }, children);
}
TableActions.displayName = "TableActions"; // ----------------------------------------------------------------------------
// TableSkeleton
// ----------------------------------------------------------------------------
function TableSkeleton({
  cellPadding,
  columns,
  rows = 10,
  ...rest
}) {
  const enabled = useFeatureFlag.useFeatureFlag(cssModulesFlag);
  const {
    gridTemplateColumns
  } = useTable.useTableLayout(columns);
  return /*#__PURE__*/React__default.default.createElement(Table, _extends({}, rest, {
    cellPadding: cellPadding,
    gridTemplateColumns: gridTemplateColumns
  }), /*#__PURE__*/React__default.default.createElement(TableHead, null, /*#__PURE__*/React__default.default.createElement(TableRow, null, Array.isArray(columns) ? columns.map((column, i) => {
    return /*#__PURE__*/React__default.default.createElement(TableHeader, {
      key: i
    }, typeof column.header === 'string' ? column.header : column.header());
  }) : null)), /*#__PURE__*/React__default.default.createElement(TableBody, null, /*#__PURE__*/React__default.default.createElement(TableRow, null, Array.from({
    length: columns.length
  }).map((_, i) => {
    return /*#__PURE__*/React__default.default.createElement(TableCell, {
      key: i,
      className: clsx.clsx('TableCellSkeleton', {
        [Table_module.TableCellSkeleton]: enabled
      })
    }, /*#__PURE__*/React__default.default.createElement(_VisuallyHidden, null, "Loading"), /*#__PURE__*/React__default.default.createElement("div", {
      className: clsx.clsx('TableCellSkeletonItems', {
        [Table_module.TableCellSkeletonItems]: enabled
      })
    }, Array.from({
      length: rows
    }).map((_, i) => {
      return /*#__PURE__*/React__default.default.createElement("div", {
        key: i,
        className: clsx.clsx('TableCellSkeletonItem', {
          [Table_module.TableCellSkeletonItem]: enabled
        })
      }, /*#__PURE__*/React__default.default.createElement(SkeletonText.SkeletonText, null));
    })));
  }))));
}
TableSkeleton.displayName = "TableSkeleton";

exports.Table = Table;
exports.TableActions = TableActions;
exports.TableBody = TableBody;
exports.TableCell = TableCell;
exports.TableCellPlaceholder = TableCellPlaceholder;
exports.TableContainer = TableContainer;
exports.TableDivider = TableDivider;
exports.TableHead = TableHead;
exports.TableHeader = TableHeader;
exports.TableRow = TableRow;
exports.TableSkeleton = TableSkeleton;
exports.TableSortHeader = TableSortHeader;
exports.TableSubtitle = TableSubtitle;
exports.TableTitle = TableTitle;
